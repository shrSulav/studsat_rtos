state transition, hardware both

debug printf used

tracealyzer used